# 产品数据分析模块需求说明

## 1. 简介

本模块旨在通过分析亚马逊销售数据，为业务员提供库存状况的全面视图，并识别需要关注的关键问题，如周转缓慢、库存不足和零销量产品。通过数据合并和分析，本模块将帮助业务员优化库存管理，提高销售效率。

## 2. 功能概述

本模块主要包含以下功能：

*   **数据读取：** 从 Excel 文件读取产品销售和库存数据。
*   **数据合并：**
    *   合并欧盟地区同一 ASIN 在同一店名前缀下的销量和库存。
    *   合并英国、加拿大、澳大利亚、美国、欧洲同一 ASIN 的不同店名的库存和销量。
*   **库存分析：**
    *   计算库存周转天数。
    *   识别周转超标、断货和零销量库存点。
*   **报表生成：**
    *   生成每个业务员负责的库存点数量统计表。
    *   生成合并后的库存点数据表。
    *   生成周转超标情况表。
    *   生成断货情况表。
    *   生成 0 动销情况表。
*   **数据展示：**
    *   在页面上显示库存点总数、库存周转较慢产品数量、低库存产品数量和缺货产品数量。
*   **报表下载：** 提供所有生成报表的下载功能。

## 3. 详细需求

### 3.1 数据读取

*   **数据源：** Excel 文件。
*   **数据内容：** Excel 文件应包含以下列：
    *   ASIN
    *   品名
    *   SKU
    *   店铺
    *   站点
    *   分类
    *   业务员
    *   产品标签
    *   30天销量
    *   销量
    *   平均销量
    *   订单量
    *   广告曝光量
    *   广告点击量
    *   广告花费
    *   广告订单量
    *   促销订单量
    *   销售额
    *   净销售额
    *   平均售价
    *   退款率
    *   FBA可售
    *   入库已发货
    *   FBA不可售
    *   FBA可用
    *   FBA在途
    *   本地仓可用
    *   FBA可售天数
*   **数据校验：** 程序应能校验 Excel 文件中是否存在缺失或格式错误的数据，并给出相应的提示。

### 3.2 数据合并

*   **欧盟地区合并：**
    *   识别同一 ASIN 在同一店名前缀下的欧盟地区店铺，包含FR、DE、IT、ES、PT、NL、BE、LU、AT、DK、SE、FI、EE、HR、SI、CZ、RO、BG、GR、CY、MT、IS、LI、MC、SM、VA、IT、MC、SM、VA、IT、MC、SM、VA这些后缀的，都是欧盟店铺。店铺名称类似“03 ZipCozy-UK”，国家后缀和店铺名称用“-”连接。
    *   同一个ASIN可能会在不同店铺有库存，这些库存都存在欧盟的FBA仓库，这个库存点，然后整个欧盟所有国家用同一份库存。所以需要对欧盟的库存进行合并。
        量步合并流程：
        第一步：每个店铺，从所有后缀中选出"FBA可用+FBA在途"之和最大的国家作为该店铺的最佳库存代表
        第二步：将同一个ASIN在每个店铺的最佳库存代表，进行合并，形成同一个ASIN在欧盟的库存点
        注意：同一个ASIN的同一个库存点，FBA可用分别累加、FBA在途分别累加、本地仓可用不要进行累加（因为是在国内同一个仓库，只有1份）
        显示方式：
        欧盟地区统一显示为"欧盟"，不再区分店铺前缀
        非欧盟地区仍然按国家显示
*   **非欧盟地区合并：**
*   像CA,US,UK,AU等非欧盟地区数据合并逻辑如下
    *   识别同一 ASIN 在同一个国家的店铺，不同店名前缀下的库存和销量（例如，`03Doit-UK`、`01VivaJoy-UK`、`01MumEZ-UK` 等）。
    *   将这些店铺的销量进行加总。
    *   将这些店铺的库存进行加总，分别展示FBA可用和FBA在途
* 广告数据合并
    * 同一个库存点，广告数据进行合并，广告曝光量、广告点击量、广告花费、广告订单量进行加总
    * 广告点击率、广告转化率、ACOAS三个字段，  广告点击率=广告点击量/广告曝光量 , 广告转化率=广告订单量/广告点击量, ACOAS =  广告花费/（日均销售额*7）
### 3.3 库存分析

*   **总库存计算：**
    *   总库存 = FBA可用 + FBA在途 + 本地仓可用
*   **库存周转天数计算：**
    *   库存周转天数 = 总库存 /平均销量
*   **周转超标判断：**
    *   库存周转天数 > 100 天
*   **库存不足判断：**
    *   库存周转天数 < 45 天  
*   **断货判断：**
    *   FBA可用天数小于3天（FBA可用/平均销量 < 3）。
*   **零销量判断：**
    *   7 天销量为 0。

### 3.4 数据展示

*   在页面上显示以下统计数据：
*   汇总数据：
    *   库存点总数
    *   库存周转较慢产品数量（周转天数超标的产品数量）
    *   低库存产品数量（FBA 可售数量低于安全库存阈值，安全库存阈值可配置）
    *   缺货产品数量（FBA 可售数量为 0 的产品数量）
    *   有效库存点数量：日均销售额 ≥ 16.7
*   每个库存点的数据，以列表形式展示。ASIN、品名、业务员、库存点、FBA可用、FBA在途、本地仓可用、平均销量、总库存、库存周转天数。
*   ASIN、品名、业务员、库存点支持搜索和点击筛选
*   周转超标产品、低库存产品、缺货产品、有效库存点支持点击筛选
*   库存点详情列表，周转超标产品用蓝色，低库存产品用红色，缺货产品用紫色，周转合格产品用黑色。周转超标指库存周转天数大于100天，低库存指库存周转天数小于45天，缺货指FBA可用天数小于3天，周转合格指库存周转天数在45天到100天之间。    

## 4. 数据处理逻辑

1.  **读取 Excel 数据。**
2.  **数据清洗：** 处理缺失值、异常值和数据类型转换。
3.  **数据合并：**
    *   按照 3.2 节的规则合并欧盟地区和全球数据。
4.  **库存分析：**
    *   计算总库存（FBA可用 + FBA在途 + 本地仓可用）。
    *   计算库存周转天数。
    *   根据 3.3 节的规则判断周转超标、断货和零销量情况。
5.  **数据展示：**
    *   在页面上展示统计数据。

## 5. 其他需求

*   **性能：** 程序应能快速处理大量数据。
*   **易用性：** 界面应简洁明了，操作方便。
*   **错误处理：** 程序应能处理各种异常情况，并给出友好的提示。

## 6. 术语解释

*   **ASIN：** 亚马逊标准识别号。
*   **SKU：** 库存单位。
*   **FBA：** 亚马逊物流。
*   **库存点：** 同一 ASIN 在特定区域（如英国、欧盟、加拿大、美国、澳大利亚）的库存集合。   